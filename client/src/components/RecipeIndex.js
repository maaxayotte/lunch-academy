import React, { useState, useEffect } from "react"
import RecipeTile from "./RecipeTile"

const RecipeIndex = props => {
  const [recipes, setRecipes] = useState([])

  const getRecipes = async () => {
    try{
      const response = await fetch('/api/v1/recipes')
      if(!response.ok) {
        const errorMessage = `${response.status} ${response.statusText}`
        const error = new Error(errorMessage);
        throw(error)
      }
      const recipesBody = await response.json()
      setRecipes(recipesBody.recipes)
    } catch(error) {
      console.error(`Error in fetch: ${error.message}`)
    }
  }
  
  useEffect(() => {
    getRecipes()
  }, [])

  const recipeTiles = recipes.map(recipe => {
    return (
      <RecipeTile
        key={recipe.id}
        recipe={recipe}
      />
    )
  })

  const img = 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/Pg0KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDE5LjAuMCwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPg0KPHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJDYXBhXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4Ig0KCSB2aWV3Qm94PSIwIDAgNTEyLjAwMiA1MTIuMDAyIiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA1MTIuMDAyIDUxMi4wMDI7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxwYXRoIHN0eWxlPSJmaWxsOiNGMEVDRUQ7IiBkPSJNNDA1Ljg3MSwxMzguNTY0Yy0xLjUxNS0xLjYzNS0zLjY0Mi0yLjU2NC01Ljg3LTIuNTY0aC0yODhjLTIuMjI5LDAtNC4zNTUsMC45MjktNS44NywyLjU2NA0KCWMtMS41MTQsMS42MzUtMi4yNzcsMy44MjctMi4xMDYsNi4wNDlsMjQsMzEyYzAuMzIsNC4xNjgsMy43OTYsNy4zODYsNy45NzcsNy4zODZoMjQwYzQuMTgxLDAsNy42NTYtMy4yMTgsNy45NzctNy4zODZsMjQtMzEyDQoJQzQwOC4xNDgsMTQyLjM5Miw0MDcuMzg1LDE0MC4xOTksNDA1Ljg3MSwxMzguNTY0eiIvPg0KPHBhdGggc3R5bGU9ImZpbGw6I0U4RTJFNDsiIGQ9Ik0xNjguMDI0LDQ1Ni42MTRsLTI0LTMxMmMtMC4xNzEtMi4yMjIsMC41OTMtNC40MTUsMi4xMDYtNi4wNDljMS41MTUtMS42MzUsMy42NDItMi41NjQsNS44Ny0yLjU2NA0KCWgtNDBjLTIuMjI5LDAtNC4zNTUsMC45MjktNS44NywyLjU2NGMtMS41MTQsMS42MzUtMi4yNzcsMy44MjctMi4xMDYsNi4wNDlsMjQsMzEyYzAuMzIsNC4xNjgsMy43OTYsNy4zODYsNy45NzcsNy4zODZoNDANCglDMTcxLjgyLDQ2NCwxNjguMzQ1LDQ2MC43ODIsMTY4LjAyNCw0NTYuNjE0eiIvPg0KPGc+DQoJPHBhdGggc3R5bGU9ImZpbGw6I0UxRDhEQzsiIGQ9Ik0yNTYuMDAxLDM3NmMtNC40MTgsMC04LTMuNTgyLTgtOFYyNjRjMC00LjQxOCwzLjU4Mi04LDgtOHM4LDMuNTgyLDgsOHYxMDQNCgkJQzI2NC4wMDEsMzcyLjQxOCwyNjAuNDE5LDM3NiwyNTYuMDAxLDM3NnoiLz4NCgk8cGF0aCBzdHlsZT0iZmlsbDojRTFEOERDOyIgZD0iTTMwNC4wMSwzNzYuMDAxYy0wLjQ3NSwwLTAuOTU2LTAuMDQyLTEuNDM5LTAuMTNjLTQuMzQ4LTAuNzkxLTcuMjMtNC45NTUtNi40NC05LjMwMmwxNi04OA0KCQljMC43OS00LjM0Niw0Ljk1NC03LjIyOSw5LjMwMi02LjQ0YzQuMzQ4LDAuNzkxLDcuMjMsNC45NTUsNi40NCw5LjMwMmwtMTYsODhDMzExLjE3LDM3My4yOTQsMzA3LjgwMiwzNzYuMDAxLDMwNC4wMSwzNzYuMDAxeiIvPg0KCTxwYXRoIHN0eWxlPSJmaWxsOiNFMUQ4REM7IiBkPSJNMjA3Ljk5MiwzNzYuMDAxYy0zLjc5MywwLTcuMTYtMi43MDctNy44NjItNi41N2wtMTYtODhjLTAuNzktNC4zNDcsMi4wOTMtOC41MTIsNi40NC05LjMwMg0KCQljNC4zNDMtMC43OTIsOC41MTEsMi4wOTMsOS4zMDIsNi40NGwxNiw4OGMwLjc5LDQuMzQ3LTIuMDkzLDguNTEyLTYuNDQsOS4zMDJDMjA4Ljk0OCwzNzUuOTU5LDIwOC40NjcsMzc2LjAwMSwyMDcuOTkyLDM3Ni4wMDF6Ig0KCQkvPg0KPC9nPg0KPHBhdGggc3R5bGU9ImZpbGw6I0U4RTJFNDsiIGQ9Ik00MDAuMDAxLDEzNmgtMjg4Yy0yLjIyOSwwLTQuMzU1LDAuOTI5LTUuODcsMi41NjRjLTEuNTE0LDEuNjM1LTIuMjc3LDMuODI3LTIuMTA2LDYuMDQ5DQoJbDkuNzk3LDEyNy4zNjJjMzEuNzI4LTAuNTEyLDYxLjMzNS0xNC4zNzgsODEuOTA3LTM3LjUzNWMxOC4zNTQsOC45MTksMzguNDc5LDEzLjU2LDU5LjI3MiwxMy41Ng0KCWMyMS4zOTMsMCw0Mi4wMTQtNC44NzksNjAuNzI3LTE0LjI1N2M1Ljk0LDYuNzgxLDEyLjcsMTIuODYzLDIwLjEwMywxOC4wNDhjMTguMzgsMTIuODczLDM5LjkwMywxOS44MTYsNjIuMzUxLDIwLjE3NA0KCWw5Ljc5Ni0xMjcuMzUyYzAuMTcxLTIuMjIyLTAuNTkzLTQuNDE1LTIuMTA2LTYuMDQ5QzQwNC4zNTYsMTM2LjkyOSw0MDIuMjI5LDEzNiw0MDAuMDAxLDEzNnoiLz4NCjxwYXRoIHN0eWxlPSJmaWxsOiNGMEVDRUQ7IiBkPSJNNDAwLjAwMSw3MmMtMTMuMDUxLDAtMjUuODM4LDIuODgyLTM3LjUyNCw4LjQwNEMzNDguNjYsMzMuMjIyLDMwNS4wNjgsMCwyNTUuMDAxLDANCgljLTQ5LjYwMiwwLTkzLjEzOSwzMi44OTktMTA3LjIzMiw3OS41ODlDMTM2LjU2Miw3NC42MDMsMTI0LjM3NSw3MiwxMTIuMDAxLDcyYy00OC41MjMsMC04OCwzOS40NzctODgsODhzMzkuNDc3LDg4LDg4LDg4DQoJYzMyLjQ4MiwwLDYxLjcwMS0xNy41NDEsNzcuMDU0LTQ1LjQ3NUMyMDguMTM1LDIxNi40MzcsMjMxLjE4NywyMjQsMjU1LjAwMSwyMjRjMjQuNDgxLDAsNDguMDMtNy45MzUsNjcuMzc5LTIyLjUzMg0KCWM2LjQ5NiwxMi4xNjksMTUuNzY2LDIyLjY0MywyNy4yMTksMzAuNjY1YzE0LjgyLDEwLjM4LDMyLjI0OSwxNS44NjcsNTAuNDAyLDE1Ljg2N2M0OC41MjMsMCw4OC0zOS40NzcsODgtODgNCglTNDQ4LjUyNCw3Miw0MDAuMDAxLDcyeiIvPg0KPHBhdGggc3R5bGU9ImZpbGw6I0U4RTJFNDsiIGQ9Ik00OC4wMDEsMTc2YzAtNDguNTIzLDM5LjQ3Ny04OCw4OC04OGMxMi4zNzQsMCwyNC41NjEsMi42MDMsMzUuNzY4LDcuNTg5DQoJQzE4NS44NjIsNDguODk5LDIyOS4zOTksMTYsMjc5LjAwMSwxNmMxNy42OTEsMCwzNC41NjQsNC4xNjQsNDkuNjEsMTEuNjFDMzA4Ljc2NywxMC4zMiwyODIuODkzLDAsMjU1LjAwMSwwDQoJYy00OS42MDIsMC05My4xMzksMzIuODk5LTEwNy4yMzIsNzkuNTg5QzEzNi41NjIsNzQuNjAzLDEyNC4zNzUsNzIsMTEyLjAwMSw3MmMtNDguNTIzLDAtODgsMzkuNDc3LTg4LDg4DQoJYzAsMzUuNjkyLDIxLjM2LDY2LjQ4OCw1MS45NjgsODAuMjhDNTguNzcxLDIyNC4yMDgsNDguMDAxLDIwMS4zNCw0OC4wMDEsMTc2eiIvPg0KPHBhdGggc3R5bGU9ImZpbGw6I0ZGQkM2ODsiIGQ9Ik0xMjEuMjA4LDM2OGw2LjgxNiw4OC42MTRjMC4zMiw0LjE2OCwzLjc5Niw3LjM4Niw3Ljk3Nyw3LjM4NmgyNDBjNC4xODEsMCw3LjY1Ni0zLjIxOCw3Ljk3Ny03LjM4Ng0KCUwzOTAuNzk0LDM2OEgxMjEuMjA4eiIvPg0KPHBhdGggc3R5bGU9ImZpbGw6I0ZGQTUzNTsiIGQ9Ik0xNjguMDI0LDQ1Ni42MTRMMTYxLjIwOCwzNjhoLTQwbDYuODE2LDg4LjYxNGMwLjMyLDQuMTY4LDMuNzk2LDcuMzg2LDcuOTc3LDcuMzg2aDQwDQoJQzE3MS44Miw0NjQsMTY4LjM0NSw0NjAuNzgyLDE2OC4wMjQsNDU2LjYxNHoiLz4NCjxwYXRoIHN0eWxlPSJmaWxsOiNFMzZENDU7IiBkPSJNMzEyLjAwMSw0MjRjLTEyLjg1MiwwLTQzLjcsMTYuMTMyLTU2LDIyLjg1NmMtMTIuMy02LjcyNC00My4xNDgtMjIuODU2LTU2LTIyLjg1Ng0KCWMtMTcuNjQ1LDAtMzIsMTQuMzU1LTMyLDMyczE0LjM1NSwzMiwzMiwzMmMxMC4wMjEsMCwzMC45ODktOS44MTEsNDUuNTcxLTE3LjMyMWMtMi45ODcsOC41NDYtOS41NjksMTkuMDk2LTI0LjA2MSwyNi4xMjINCgljLTMuOTc2LDEuOTI4LTUuNjM2LDYuNzEzLTMuNzA4LDEwLjY4OWMxLjM4MiwyLjg1Miw0LjIzNCw0LjUxMiw3LjIwNCw0LjUxMmMxLjE3MSwwLDIuMzYtMC4yNTgsMy40ODQtMC44MDMNCgljMTMuODY1LTYuNzIyLDIyLjMzNy0xNS45MDYsMjcuNTEtMjQuODc5YzUuMTcyLDguOTczLDEzLjY0NSwxOC4xNTYsMjcuNTEsMjQuODc5YzEuMTI0LDAuNTQ1LDIuMzEzLDAuODAzLDMuNDg0LDAuODAzDQoJYzIuOTcsMCw1LjgyMi0xLjY2MSw3LjIwNC00LjUxMmMxLjkyOC0zLjk3NiwwLjI2OC04Ljc2MS0zLjcwOC0xMC42ODljLTE0LjUzMi03LjA0Ni0yMS4xMTktMTcuNTkxLTI0LjA5NS0yNi4xNA0KCUMyODAuOTc5LDQ3OC4xNzQsMzAxLjk3Miw0ODgsMzEyLjAwMSw0ODhjMTcuNjQ1LDAsMzItMTQuMzU1LDMyLTMyUzMyOS42NDYsNDI0LDMxMi4wMDEsNDI0eiBNMjAwLjAwMSw0NzJjLTguODIyLDAtMTYtNy4xNzgtMTYtMTYNCglzNy4xNzgtMTYsMTYtMTZjNS40MzgsMCwyMi40ODMsNy40MzQsMzkuMTA1LDE2LjAwMUMyMjIuNDg4LDQ2NC41NjcsMjA1LjQ0NCw0NzIsMjAwLjAwMSw0NzJ6IE0zMTIuMDAxLDQ3Mg0KCWMtNS40MzgsMC0yMi40ODMtNy40MzQtMzkuMTA1LTE2LjAwMUMyODkuNTE0LDQ0Ny40MzMsMzA2LjU1OCw0NDAsMzEyLjAwMSw0NDBjOC44MjIsMCwxNiw3LjE3OCwxNiwxNlMzMjAuODIzLDQ3MiwzMTIuMDAxLDQ3MnoiLz4NCjxnPg0KPC9nPg0KPGc+DQo8L2c+DQo8Zz4NCjwvZz4NCjxnPg0KPC9nPg0KPGc+DQo8L2c+DQo8Zz4NCjwvZz4NCjxnPg0KPC9nPg0KPGc+DQo8L2c+DQo8Zz4NCjwvZz4NCjxnPg0KPC9nPg0KPGc+DQo8L2c+DQo8Zz4NCjwvZz4NCjxnPg0KPC9nPg0KPGc+DQo8L2c+DQo8Zz4NCjwvZz4NCjwvc3ZnPg0K'

  return (
    <div className="row background-runner">
      <div className="small-8 small-centered columns main-container">
        <h1 className="text-center">Top Recipes
          <img src={img} className='crazyImg'/>
        </h1>
        <div>
          {recipeTiles}
        </div>
      </div>
    </div>
  )
}

export default RecipeIndex